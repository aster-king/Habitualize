<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habitualize - The Daily Habit Builder</title>
    <style>
        :root {
            --bg-base: #f8f9fa;
            --bg-surface: #ffffff;
            --text-base: #212529;
            --text-subtle: #6c757d;
            --text-muted: #adb5bd;
            --accent-green: #40c057;
            --accent-green-light: #e6f8ea;
            --accent-red: #fa5252;
            --accent-orange: #fd7e14;
            --border: #e9ecef;
            --shadow: rgba(108, 117, 125, 0.15);
        }

        [data-theme="dark"] {
            --bg-base: #121212;
            --bg-surface: #1e1e1e;
            --text-base: #e0e0e0;
            --text-subtle: #888888;
            --text-muted: #6c757d;
            --accent-green: #40c057;
            --accent-green-light: #2c3e32;
            --accent-red: #fa5252;
            --accent-orange: #fd7e14;
            --border: #333333;
            --shadow: rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Arial, sans-serif;
            background: var(--bg-base);
            color: var(--text-base);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Mobile Header */
        .mobile-header {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border);
            z-index: 999;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }

        .mobile-header-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-base);
        }

        .hamburger {
            width: 30px;
            height: 24px;
            position: relative;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .hamburger span {
            width: 100%;
            height: 3px;
            background: var(--text-base);
            border-radius: 2px;
            transition: all 0.3s;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(8px, 8px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }

        /* Left Sidebar */
        .sidebar {
            width: 240px;
            background: var(--bg-surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 30px 15px;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .app-title {
            font-size: 20pt;
            font-weight: 600;
            color: var(--text-base);
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .nav-button {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            margin-bottom: 8px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--text-subtle);
            font-size: 11pt;
            font-weight: 600;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
        }

        .nav-button:hover {
            background: var(--border);
            color: var(--text-base);
        }

        .nav-button.active {
            background: var(--accent-green-light);
            color: var(--accent-green);
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .sidebar-footer {
            margin-top: auto;
        }

        .about-text {
            font-size: 10pt;
            color: var(--text-muted);
            text-align: center;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .theme-toggle {
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            transition: background 0.2s;
        }

        .theme-toggle:hover {
            background: var(--bg-base);
        }

        .theme-icon {
            width: 22px;
            height: 22px;
            stroke: var(--text-subtle);
            fill: none;
            stroke-width: 2;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .page {
            flex: 1;
            overflow-y: auto;
            padding: 40px 50px;
        }

        .page-title {
            font-size: 32pt;
            font-weight: 300;
            color: var(--text-base);
            margin-bottom: 30px;
        }

        .page-content {
            display: flex;
            gap: 30px;
        }

        .left-panel {
            flex: 7;
        }

        /* Right Panel */
        .right-panel {
            flex: 3;
            min-width: 400px;
            max-width: 550px;
            transition: transform 0.3s ease;
        }

        /* Card */
        .card {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px var(--shadow);
        }

        .card-title {
            font-size: 10pt;
            font-weight: bold;
            color: var(--text-subtle);
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 15px;
        }

        /* Habit Row */
        .habit-row {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 10px;
            min-height: 70px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .habit-row:hover {
            border-color: var(--text-subtle);
        }

        .habit-row.selected {
            border: 2px solid var(--accent-green);
        }

        .habit-row.completed {
            background: var(--accent-green-light);
        }

        .habit-checkbox {
            width: 22px;
            height: 22px;
            min-width: 22px;
            border: 2px solid var(--border);
            border-radius: 7px;
            cursor: pointer;
            accent-color: var(--accent-green);
        }

        .habit-checkbox:checked {
            border-color: var(--accent-green);
        }

        .habit-name {
            flex: 1;
            font-size: 11pt;
            font-weight: 500;
            color: var(--text-base);
            word-break: break-word;
        }

        .habit-row.completed .habit-name {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        .habit-points {
            font-size: 10pt;
            color: var(--text-subtle);
            white-space: nowrap;
        }

        .habit-row.completed .habit-points {
            color: var(--text-muted);
        }

        .habit-actions {
            display: none;
            gap: 5px;
            flex-wrap: wrap;
        }

        .habit-row.management-mode .habit-actions {
            display: flex;
        }

        .habit-row.management-mode .habit-checkbox {
            display: none;
        }

        .icon-button {
            width: 36px;
            height: 36px;
            min-width: 36px;
            border: none;
            background: transparent;
            border-radius: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .icon-button:hover {
            background: var(--bg-base);
        }

        .icon-button svg {
            width: 18px;
            height: 18px;
            stroke: var(--text-subtle);
            fill: none;
            stroke-width: 2;
        }

        .icon-button.delete svg {
            stroke: var(--accent-red);
        }

        /* Progress Circle */
        .progress-container {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .donut-circle {
            width: 140px;
            height: 140px;
            min-width: 140px;
            position: relative;
        }

        .progress-svg {
            transform: rotate(-90deg);
        }

        .progress-circle-bg {
            fill: none;
            stroke: var(--border);
            stroke-width: 12;
        }

        .progress-circle-fg {
            fill: none;
            stroke: var(--accent-green);
            stroke-width: 12;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.6s;
        }

        .separator {
            width: 1px;
            height: 100px;
            background: var(--border);
        }

        .progress-text-view {
            flex: 1;
        }

        .progress-main {
            font-size: 26pt;
            font-weight: 600;
            color: var(--text-base);
            margin-bottom: 5px;
        }

        .progress-sub {
            font-size: 10pt;
            color: var(--text-subtle);
        }

        /* Weekly Streak */
        .streak-container {
            display: flex;
            gap: 5px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .streak-day {
            width: 38px;
            height: 38px;
            border: 2px solid transparent;
            border-radius: 19px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11pt;
            font-weight: 600;
            background: var(--bg-base);
            color: var(--text-subtle);
        }

        .streak-day.completed {
            background: var(--accent-green-light);
            color: var(--accent-green);
        }

        .streak-day.today {
            border-color: var(--accent-green);
        }

        /* Form Inputs */
        input[type="text"],
        input[type="number"],
        input[type="date"],
        select {
            width: 100%;
            padding: 12px;
            margin-bottom: 12px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-base);
            font-size: 11pt;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        input:focus,
        select:focus {
            outline: none;
            border: 2px solid var(--accent-green);
            padding: 11px;
        }

        /* Buttons */
        .btn-primary {
            width: 100%;
            padding: 12px 20px;
            background: var(--accent-green);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 10pt;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn-primary:hover {
            background: #38b04d;
        }

        .text-toggle-button {
            background: transparent;
            border: none;
            color: var(--text-subtle);
            font-size: 10pt;
            font-weight: 600;
            cursor: pointer;
            padding: 4px 8px;
            text-align: right;
        }

        .text-toggle-button:hover {
            color: var(--text-base);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
            font-size: 11pt;
            font-style: italic;
        }

        /* Goals */
        .goal-row {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 12px;
            min-height: 80px;
            flex-wrap: wrap;
        }

        .goal-info {
            flex: 1;
            min-width: 200px;
        }

        .goal-name {
            font-size: 11pt;
            font-weight: 600;
            color: var(--text-base);
            margin-bottom: 5px;
            word-break: break-word;
        }

        .goal-meta {
            font-size: 10pt;
            color: var(--text-subtle);
            font-weight: 600;
        }

        .goal-status {
            display: inline-block;
            margin-right: 10px;
        }

        .goal-status.completed { color: var(--accent-green); }
        .goal-status.in-progress { color: var(--accent-orange); }
        .goal-status.not-started { color: var(--text-muted); }

        .goal-countdown {
            text-align: right;
            min-width: 180px;
        }

        .countdown-text {
            font-size: 14pt;
            font-weight: 600;
            color: var(--text-base);
        }

        .countdown-text.overdue {
            color: var(--accent-red);
        }

        .deadline-text {
            font-size: 10pt;
            color: var(--text-subtle);
            margin-top: 2px;
        }

        /* Donut Progress for Goals */
        .goal-donut {
            width: 180px;
            height: 180px;
            margin: 0 auto;
        }

        /* Stats */
        .stat-item {
            text-align: center;
        }

        .stat-main {
            font-size: 28pt;
            font-weight: 600;
            color: var(--text-base);
            margin-bottom: 2px;
        }

        .stat-sub {
            font-size: 10pt;
            color: var(--text-subtle);
        }

        .stats-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stats-row .stat-item {
            flex: 1;
            min-width: 120px;
        }

        /* Hidden pages */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-base);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-subtle);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1001;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-surface);
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 18pt;
            font-weight: 600;
            color: var(--text-base);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-subtle);
            cursor: pointer;
            width: 32px;
            height: 32px;
            min-width: 32px;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .section-title {
            font-size: 18pt;
            font-weight: 600;
            color: var(--text-base);
        }

        .archived-container {
            margin-top: 30px;
        }

        /* Overlays */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
        }

        .sidebar-overlay.active {
            display: block;
        }

        .right-panel-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
        }

        .right-panel-overlay.active {
            display: block;
        }

        /* ===== RESPONSIVE STYLES ===== */
        
        /* Tablet Styles */
        @media (max-width: 1024px) {
            .page-content {
                flex-direction: column;
            }

            .right-panel {
                min-width: 100%;
                max-width: 100%;
            }

            .goal-countdown {
                min-width: 140px;
            }

            .countdown-text {
                font-size: 12pt;
            }
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .mobile-header {
                display: flex;
            }

            /* Left Sidebar - Slide from left */
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                bottom: 0;
                z-index: 1000;
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            /* Right Panel - Slide from right */
            .right-panel {
                position: fixed;
                top: 60px;
                right: 0;
                bottom: 0;
                width: 90%;
                max-width: 400px;
                min-width: unset;
                background: var(--bg-base);
                z-index: 1000;
                transform: translateX(100%);
                overflow-y: auto;
                padding: 20px;
            }

            .right-panel.active {
                transform: translateX(0);
            }

            .main-content {
                margin-top: 60px;
                width: 100%;
            }

            .page {
                padding: 20px 15px;
            }

            .page-content {
                display: block;
            }

            .left-panel {
                width: 100%;
            }

            .page-title {
                font-size: 24pt;
                margin-bottom: 20px;
            }

            .card {
                padding: 20px;
                margin-bottom: 20px;
            }

            .habit-row {
                padding: 15px;
                gap: 10px;
                min-height: 60px;
            }

            .habit-name {
                font-size: 10pt;
            }

            .habit-points {
                font-size: 9pt;
            }

            .habit-actions {
                gap: 3px;
            }

            .icon-button {
                width: 32px;
                height: 32px;
                min-width: 32px;
            }

            .icon-button svg {
                width: 16px;
                height: 16px;
            }

            .progress-container {
                flex-direction: column;
                gap: 15px;
            }

            .separator {
                display: none;
            }

            .donut-circle {
                width: 120px;
                height: 120px;
                min-width: 120px;
            }

            .progress-main {
                font-size: 22pt;
            }

            .goal-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .goal-countdown {
                width: 100%;
                text-align: left;
            }

            .goal-info {
                min-width: 100%;
            }

            .section-title {
                font-size: 16pt;
            }

            .stat-main {
                font-size: 22pt;
            }

            .modal-content {
                padding: 20px;
            }

            .modal-title {
                font-size: 16pt;
            }

            .about-text {
                font-size: 9pt;
            }
        }

        /* Small Mobile */
        @media (max-width: 480px) {
            .page {
                padding: 15px 10px;
            }

            .page-title {
                font-size: 20pt;
            }

            .card {
                padding: 15px;
            }

            .habit-row {
                padding: 12px;
            }

            .donut-circle {
                width: 100px;
                height: 100px;
                min-width: 100px;
            }

            .progress-main {
                font-size: 18pt;
            }

            .progress-sub {
                font-size: 9pt;
            }

            .streak-day {
                width: 34px;
                height: 34px;
                font-size: 10pt;
            }

            .goal-donut {
                width: 150px;
                height: 150px;
            }

            .stat-main {
                font-size: 18pt;
            }

            .stat-sub {
                font-size: 9pt;
            }

            input[type="text"],
            input[type="number"],
            input[type="date"],
            select {
                font-size: 16px;
            }

            .right-panel {
                width: 95%;
            }
        }

        /* Landscape Mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .page {
                padding: 15px 20px;
            }

            .progress-container {
                flex-direction: row;
            }

            .separator {
                display: block;
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Header -->
    <div class="mobile-header">
        <div class="hamburger" onclick="toggleMobileSidebar()">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="mobile-header-title" id="current-page-title">Daily Tracker</div>
        <div class="hamburger" id="right-hamburger" onclick="toggleRightPanel()">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <!-- Left Sidebar Overlay -->
    <div class="sidebar-overlay" onclick="toggleMobileSidebar()"></div>

    <!-- Right Panel Overlay -->
    <div class="right-panel-overlay" onclick="toggleRightPanel()"></div>

    <!-- Left Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="app-title">Habitualize</div>
        
        <button class="nav-button active" data-page="daily" onclick="navigateTo('daily')">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            Daily Tracker
        </button>

        <button class="nav-button" data-page="goals" onclick="navigateTo('goals')">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                <line x1="4" y1="22" x2="4" y2="15"></line>
            </svg>
            My Goals
        </button>

        <button class="nav-button" data-page="habits" onclick="navigateTo('habits')">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
            </svg>
            Manage Habits
        </button>

        <button class="nav-button" data-page="progress" onclick="navigateTo('progress')">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
            </svg>
            Progress
        </button>

        <div class="sidebar-footer">
            <div class="about-text">
                Application Developed and<br>Designed by <b>Shikhar Bansal</b>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">
                <svg class="theme-icon" id="theme-icon" viewBox="0 0 24 24">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Daily Tracker Page -->
        <div class="page active" id="page-daily">
            <h1 class="page-title">Daily Tracker</h1>
            <div class="page-content">
                <div class="left-panel" id="daily-habits-list"></div>
                <div class="right-panel" id="right-panel-daily">
                    <div class="card">
                        <div class="card-title">TODAY'S PROGRESS</div>
                        <div class="progress-container">
                            <div class="donut-circle">
                                <svg class="progress-svg" width="140" height="140" viewBox="0 0 140 140">
                                    <circle class="progress-circle-bg" cx="70" cy="70" r="60"></circle>
                                    <circle class="progress-circle-fg" id="progress-circle" cx="70" cy="70" r="60"></circle>
                                </svg>
                            </div>
                            <div class="separator"></div>
                            <div class="progress-text-view">
                                <div class="progress-main" id="progress-earned">0</div>
                                <div class="progress-sub" id="progress-total">of 0 Points</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">WEEKLY STREAK</div>
                        <div class="streak-container" id="streak-view">
                            <div class="empty-state">Select a habit to see its weekly streak.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- My Goals Page -->
        <div class="page" id="page-goals">
            <h1 class="page-title">My Goals</h1>
            <div class="page-content">
                <div class="left-panel" id="goals-list"></div>
                <div class="right-panel" id="right-panel-goals">
                    <div class="card">
                        <div class="card-title">GOALS PROGRESS</div>
                        <svg class="goal-donut" id="goal-donut" viewBox="0 0 180 180"></svg>
                    </div>

                    <div class="card">
                        <div class="card-title">ADD NEW GOAL</div>
                        <input type="text" id="new-goal-name" placeholder="e.g., Learn Python">
                        <input type="number" id="new-goal-points" placeholder="Points (e.g., 100)" value="100">
                        <select id="new-goal-status">
                            <option value="Not Started">Not Started</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Completed">Completed</option>
                        </select>
                        <input type="date" id="new-goal-deadline">
                        <button class="btn-primary" onclick="addGoal()">Add New Goal</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manage Habits Page -->
        <div class="page" id="page-habits">
            <h1 class="page-title">Manage Habits</h1>
            <div class="page-content">
                <div class="left-panel">
                    <div class="section-title">Active Habits</div>
                    <div id="active-habits-list"></div>

                    <div class="archived-container">
                        <div class="section-header">
                            <div class="section-title">Archived Habits</div>
                            <button class="text-toggle-button" id="toggle-archived" onclick="toggleArchived()">Show</button>
                        </div>
                        <div id="archived-count" style="font-size: 10pt; color: var(--text-muted); margin-bottom: 10px;"></div>
                        <div id="archived-habits-list" style="display: none;"></div>
                    </div>
                </div>
                <div class="right-panel" id="right-panel-habits">
                    <div class="card">
                        <div class="card-title">ADD NEW HABIT</div>
                        <input type="text" id="new-habit-name" placeholder="e.g., Read for 15 minutes">
                        <input type="number" id="new-habit-points" placeholder="Points (e.g., 10)" value="10">
                        <button class="btn-primary" onclick="addHabit()">Add New Habit</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Page -->
        <div class="page" id="page-progress">
            <h1 class="page-title">Historical Progress</h1>
            <div class="page-content">
                <div class="left-panel" id="progress-content">
                    <div class="card">
                        <div class="card-title">SELECT DATE</div>
                        <div class="empty-state">Calendar view - coming soon</div>
                    </div>
                </div>
                <div class="right-panel" id="right-panel-progress">
                    <div class="card">
                        <div class="card-title">DAILY SUMMARY</div>
                        <div class="stats-row">
                            <div class="stat-item">
                                <div class="stat-main" id="day-earned">0</div>
                                <div class="stat-sub">Points Earned</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-main" id="day-percentage">0%</div>
                                <div class="stat-sub">Completion</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">WEEKLY SUMMARY</div>
                        <div class="stats-row">
                            <div class="stat-item">
                                <div class="stat-main" id="week-earned">0/0</div>
                                <div class="stat-sub">Last 7 Days</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-main" id="week-percentage">0%</div>
                                <div class="stat-sub">Weekly Completion</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Habit Modal -->
    <div class="modal" id="edit-habit-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Habit</h2>
                <button class="modal-close" onclick="closeEditHabitModal()">&times;</button>
            </div>
            <input type="text" id="edit-habit-name">
            <input type="number" id="edit-habit-points">
            <button class="btn-primary" onclick="saveHabitEdit()">Save Changes</button>
        </div>
    </div>

    <!-- Edit Goal Modal -->
    <div class="modal" id="edit-goal-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Goal</h2>
                <button class="modal-close" onclick="closeEditGoalModal()">&times;</button>
            </div>
            <input type="text" id="edit-goal-name">
            <input type="number" id="edit-goal-points">
            <select id="edit-goal-status">
                <option value="Not Started">Not Started</option>
                <option value="In Progress">In Progress</option>
                <option value="Completed">Completed</option>
            </select>
            <input type="date" id="edit-goal-deadline">
            <button class="btn-primary" onclick="saveGoalEdit()">Save Changes</button>
        </div>
    </div>

    <script>
        let selectedHabit = null;
        let editingHabitName = null;
        let editingGoalName = null;
        let archivedVisible = false;
        let goalTimers = [];

        const pageNames = {
            'daily': 'Daily Tracker',
            'goals': 'My Goals',
            'habits': 'Manage Habits',
            'progress': 'Historical Progress'
        };

        // Mobile Sidebar Toggle
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            const hamburger = document.querySelector('.hamburger');
            
            // Close right panel if open
            const rightPanel = document.querySelector('.right-panel.active');
            if (rightPanel) {
                toggleRightPanel();
            }
            
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
            hamburger.classList.toggle('active');
            
            if (sidebar.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        // Right Panel Toggle
        function toggleRightPanel() {
            if (window.innerWidth > 768) return; // Only on mobile
            
            const activePage = document.querySelector('.page.active').id.replace('page-', '');
            const rightPanel = document.getElementById(`right-panel-${activePage}`);
            const overlay = document.querySelector('.right-panel-overlay');
            const hamburger = document.getElementById('right-hamburger');
            
            // Close left sidebar if open
            const sidebar = document.getElementById('sidebar');
            if (sidebar.classList.contains('active')) {
                toggleMobileSidebar();
            }
            
            rightPanel.classList.toggle('active');
            overlay.classList.toggle('active');
            hamburger.classList.toggle('active');
            
            if (rightPanel.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        // Navigation with mobile close
        function navigateTo(page) {
            // Close mobile sidebar if open
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('active')) {
                    toggleMobileSidebar();
                }
                
                // Close right panel if open
                const rightPanel = document.querySelector('.right-panel.active');
                if (rightPanel) {
                    const overlay = document.querySelector('.right-panel-overlay');
                    const hamburger = document.getElementById('right-hamburger');
                    rightPanel.classList.remove('active');
                    overlay.classList.remove('active');
                    hamburger.classList.remove('active');
                    document.body.style.overflow = '';
                }
            }

            // Update page title in mobile header
            document.getElementById('current-page-title').textContent = pageNames[page];

            // Update active states
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            document.querySelector(`[data-page="${page}"]`).classList.add('active');
            document.getElementById(`page-${page}`).classList.add('active');
            
            // Load page data
            if (page === 'daily') loadDailyPage();
            if (page === 'goals') loadGoalsPage();
            if (page === 'habits') loadHabitsPage();
            if (page === 'progress') loadProgressPage();
        }

        // Theme Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const icon = document.getElementById('theme-icon');
            if (newTheme === 'dark') {
                icon.innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
            } else {
                icon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
            }
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            document.getElementById('theme-icon').innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
        }

        // Daily Page
        async function loadDailyPage() {
            const response = await fetch('/api/daily-overview');
            const data = await response.json();

            const circumference = 2 * Math.PI * 60;
            const progress = (data.earned_points / data.total_points) * 100 || 0;
            const offset = circumference - (progress / 100) * circumference;
            
            const circle = document.getElementById('progress-circle');
            circle.style.strokeDasharray = circumference;
            circle.style.strokeDashoffset = offset;

            document.getElementById('progress-earned').textContent = data.earned_points;
            document.getElementById('progress-total').textContent = `of ${data.total_points} Points`;

            const habitsList = document.getElementById('daily-habits-list');
            if (data.habits.length === 0) {
                habitsList.innerHTML = '<div class="empty-state">No active habits. Go to Manage Habits to add one.</div>';
            } else {
                habitsList.innerHTML = data.habits.map(habit => `
                    <div class="habit-row ${habit.completed ? 'completed' : ''} ${selectedHabit === habit.name ? 'selected' : ''}" 
                         onclick="selectHabit('${habit.name}')">
                        <input type="checkbox" class="habit-checkbox" ${habit.completed ? 'checked' : ''} 
                               onclick="event.stopPropagation(); toggleHabit('${habit.name}', this.checked)">
                        <div class="habit-name">${habit.name}</div>
                        <div class="habit-points">${habit.points} Points</div>
                    </div>
                `).join('');
            }

            if (selectedHabit) {
                loadStreak(selectedHabit);
            }
        }

        async function toggleHabit(name, completed) {
            await fetch('/api/habits/toggle', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({name, completed})
            });
            loadDailyPage();
        }

        async function selectHabit(name) {
            selectedHabit = name;
            loadDailyPage();
        }

        async function loadStreak(habitName) {
            const response = await fetch(`/api/habits/streak/${encodeURIComponent(habitName)}`);
            const data = await response.json();

            const streakView = document.getElementById('streak-view');
            streakView.innerHTML = data.streak.map(day => `
                <div class="streak-day ${day.completed ? 'completed' : ''} ${day.is_today ? 'today' : ''}">
                    ${day.day}
                </div>
            `).join('');
        }

        async function addHabit() {
            const name = document.getElementById('new-habit-name').value.trim();
            const points = document.getElementById('new-habit-points').value;

            if (!name) {
                alert('Please enter a habit name');
                return;
            }

            const response = await fetch('/api/habits', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({name, points: parseInt(points)})
            });

            const result = await response.json();
            if (result.error) {
                alert(result.error);
            } else {
                document.getElementById('new-habit-name').value = '';
                document.getElementById('new-habit-points').value = '10';
                loadHabitsPage();
                alert('Habit added successfully!');
            }
        }

        async function loadHabitsPage() {
            const response = await fetch('/api/habits/all');
            const data = await response.json();

            const activeList = document.getElementById('active-habits-list');
            if (data.active.length === 0) {
                activeList.innerHTML = '<div class="empty-state">No active habits</div>';
            } else {
                activeList.innerHTML = data.active.map(habit => `
                    <div class="habit-row management-mode">
                        <div class="habit-name">${habit.name}</div>
                        <div class="habit-points">${habit.points} Points</div>
                        <div class="habit-actions">
                            <button class="icon-button" onclick="editHabit('${habit.name}', ${habit.points})" title="Edit">
                                <svg viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                            </button>
                            <button class="icon-button" onclick="archiveHabit('${habit.name}')" title="Archive">
                                <svg viewBox="0 0 24 24"><polyline points="21 8 21 21 3 21 3 8"></polyline><rect x="1" y="3" width="22" height="5"></rect><line x1="10" y1="12" x2="14" y2="12"></line></svg>
                            </button>
                            <button class="icon-button delete" onclick="deleteHabit('${habit.name}')" title="Delete">
                                <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            document.getElementById('archived-count').textContent = 
                `${data.archived.length} habit${data.archived.length !== 1 ? 's' : ''} hidden.`;
            
            const archivedList = document.getElementById('archived-habits-list');
            if (data.archived.length === 0) {
                archivedList.innerHTML = '<div class="empty-state">No archived habits</div>';
            } else {
                archivedList.innerHTML = data.archived.map(habit => `
                    <div class="habit-row management-mode">
                        <div class="habit-name">${habit.name}</div>
                        <div class="habit-points">${habit.points} Points</div>
                        <div class="habit-actions">
                            <button class="icon-button" onclick="unarchiveHabit('${habit.name}')" title="Unarchive">
                                <svg viewBox="0 0 24 24"><polyline points="21 8 21 21 3 21 3 8"></polyline><rect x="1" y="3" width="22" height="5"></rect><line x1="12" y1="10" x2="12" y2="14"></line><line x1="10" y1="12" x2="14" y2="12"></line></svg>
                            </button>
                            <button class="icon-button delete" onclick="deleteHabit('${habit.name}')" title="Delete">
                                <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function toggleArchived() {
            archivedVisible = !archivedVisible;
            const list = document.getElementById('archived-habits-list');
            const btn = document.getElementById('toggle-archived');
            const count = document.getElementById('archived-count');
            
            list.style.display = archivedVisible ? 'block' : 'none';
            btn.textContent = archivedVisible ? 'Hide' : 'Show';
            count.style.display = archivedVisible ? 'none' : 'block';
        }

        async function archiveHabit(name) {
            if (confirm(`Archive "${name}"?`)) {
                await fetch('/api/habits/archive', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({name, archived: true})
                });
                loadHabitsPage();
            }
        }

        async function unarchiveHabit(name) {
            await fetch('/api/habits/archive', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({name, archived: false})
            });
            loadHabitsPage();
        }

        async function deleteHabit(name) {
            if (confirm(`Permanently delete "${name}"? This cannot be undone.`)) {
                await fetch('/api/habits/delete', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({name})
                });
                loadHabitsPage();
            }
        }

        function editHabit(name, points) {
            editingHabitName = name;
            document.getElementById('edit-habit-name').value = name;
            document.getElementById('edit-habit-points').value = points;
            document.getElementById('edit-habit-modal').classList.add('active');
        }

        function closeEditHabitModal() {
            document.getElementById('edit-habit-modal').classList.remove('active');
        }

        async function saveHabitEdit() {
            const newName = document.getElementById('edit-habit-name').value.trim();
            const newPoints = document.getElementById('edit-habit-points').value;

            if (!newName) {
                alert('Please enter a habit name');
                return;
            }

            const response = await fetch('/api/habits/update', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    old_name: editingHabitName,
                    new_name: newName,
                    new_points: parseInt(newPoints)
                })
            });

            const result = await response.json();
            if (result.error) {
                alert(result.error);
            } else {
                closeEditHabitModal();
                loadHabitsPage();
            }
        }

        async function loadGoalsPage() {
            goalTimers.forEach(timer => clearInterval(timer));
            goalTimers = [];

            const response = await fetch('/api/goals');
            const data = await response.json();

            drawGoalDonut(data.stats.completed, data.stats.in_progress, data.stats.not_started);

            const goalsList = document.getElementById('goals-list');
            if (data.goals.length === 0) {
                goalsList.innerHTML = '<div class="empty-state">You haven\'t set any goals yet. Add one to get started!</div>';
            } else {
                goalsList.innerHTML = data.goals.map(goal => {
                    const statusClass = goal.status.toLowerCase().replace(' ', '-');
                    const safeId = goal.name.replace(/[^a-z0-9]/gi, '-');
                    return `
                        <div class="goal-row">
                            <div class="goal-info">
                                <div class="goal-name">${goal.name}</div>
                                <div class="goal-meta">
                                    <span class="goal-status ${statusClass}">${goal.status}</span>
                                    ${goal.points} Points
                                </div>
                            </div>
                            <div class="goal-countdown" id="countdown-${safeId}">
                                <div class="countdown-text">Calculating...</div>
                                <div class="deadline-text">Due: ${goal.deadline || 'No deadline'}</div>
                            </div>
                            <div class="habit-actions">
                                <button class="icon-button" onclick="editGoal('${goal.name}', '${goal.status}', '${goal.deadline}', ${goal.points})" title="Edit">
                                    <svg viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                                </button>
                                <button class="icon-button delete" onclick="deleteGoal('${goal.name}')" title="Delete">
                                    <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

                data.goals.forEach(goal => {
                    if (goal.deadline) {
                        startCountdown(goal.name, goal.deadline);
                    }
                });
            }
        }

        function startCountdown(goalName, deadline) {
            const id = goalName.replace(/[^a-z0-9]/gi, '-');
            const element = document.getElementById(`countdown-${id}`);
            if (!element) return;

            const updateCountdown = () => {
                const now = new Date();
                const target = new Date(deadline);
                const diff = target - now;

                const countdownText = element.querySelector('.countdown-text');

                if (diff < 0) {
                    const absDiff = Math.abs(diff);
                    const days = Math.floor(absDiff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((absDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((absDiff % (1000 * 60 * 60)) / (1000 * 60));
                    
                    countdownText.textContent = `Overdue: ${days}d ${hours}h ${minutes}m`;
                    countdownText.classList.add('overdue');
                } else {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    
                    countdownText.textContent = `${days}d ${hours}h ${minutes}m`;
                    countdownText.classList.remove('overdue');
                }
            };

            updateCountdown();
            const timer = setInterval(updateCountdown, 60000);
            goalTimers.push(timer);
        }

        function drawGoalDonut(completed, inProgress, notStarted) {
            const svg = document.getElementById('goal-donut');
            const total = completed + inProgress + notStarted;
            
            if (total === 0) {
                svg.innerHTML = `
                    <circle cx="90" cy="90" r="70" fill="none" stroke="var(--border)" stroke-width="20"></circle>
                    <text x="90" y="90" text-anchor="middle" dominant-baseline="middle" fill="var(--text-base)" font-size="18" font-weight="600">No Goals</text>
                `;
                return;
            }

            const radius = 70;
            const completedAngle = (completed / total) * 360;
            const inProgressAngle = (inProgress / total) * 360;
            const notStartedAngle = (notStarted / total) * 360;

            let currentAngle = -90;
            let paths = '';

            if (completed > 0) {
                paths += createArc(90, 90, radius, currentAngle, currentAngle + completedAngle, 'var(--accent-green)');
                currentAngle += completedAngle;
            }
            if (inProgress > 0) {
                paths += createArc(90, 90, radius, currentAngle, currentAngle + inProgressAngle, 'var(--accent-orange)');
                currentAngle += inProgressAngle;
            }
            if (notStarted > 0) {
                paths += createArc(90, 90, radius, currentAngle, currentAngle + notStartedAngle, 'var(--text-muted)');
            }

            const percentage = Math.round((completed / total) * 100);
            
            svg.innerHTML = `
                ${paths}
                <text x="90" y="80" text-anchor="middle" fill="var(--text-base)" font-size="26" font-weight="600">${percentage}%</text>
                <text x="90" y="100" text-anchor="middle" fill="var(--text-subtle)" font-size="10">Complete</text>
            `;
        }

        function createArc(x, y, radius, startAngle, endAngle, color) {
            const start = polarToCartesian(x, y, radius, endAngle);
            const end = polarToCartesian(x, y, radius, startAngle);
            const largeArc = endAngle - startAngle <= 180 ? 0 : 1;
            
            return `<path d="M ${start.x} ${start.y} A ${radius} ${radius} 0 ${largeArc} 0 ${end.x} ${end.y}" 
                    fill="none" stroke="${color}" stroke-width="20" stroke-linecap="butt"/>`;
        }

        function polarToCartesian(cx, cy, radius, angle) {
            const rad = (angle - 90) * Math.PI / 180;
            return {
                x: cx + radius * Math.cos(rad),
                y: cy + radius * Math.sin(rad)
            };
        }

        async function addGoal() {
            const name = document.getElementById('new-goal-name').value.trim();
            const points = document.getElementById('new-goal-points').value;
            const status = document.getElementById('new-goal-status').value;
            const deadline = document.getElementById('new-goal-deadline').value;

            if (!name) {
                alert('Please enter a goal name');
                return;
            }

            const response = await fetch('/api/goals', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({name, status, deadline, points: parseInt(points)})
            });

            const result = await response.json();
            if (result.error) {
                alert(result.error);
            } else {
                document.getElementById('new-goal-name').value = '';
                document.getElementById('new-goal-points').value = '100';
                document.getElementById('new-goal-status').value = 'Not Started';
                document.getElementById('new-goal-deadline').value = '';
                loadGoalsPage();
                alert('Goal added successfully!');
            }
        }

        function editGoal(name, status, deadline, points) {
            editingGoalName = name;
            document.getElementById('edit-goal-name').value = name;
            document.getElementById('edit-goal-status').value = status;
            document.getElementById('edit-goal-deadline').value = deadline;
            document.getElementById('edit-goal-points').value = points;
            document.getElementById('edit-goal-modal').classList.add('active');
        }

        function closeEditGoalModal() {
            document.getElementById('edit-goal-modal').classList.remove('active');
        }

        async function saveGoalEdit() {
            const newName = document.getElementById('edit-goal-name').value.trim();
            const newStatus = document.getElementById('edit-goal-status').value;
            const newDeadline = document.getElementById('edit-goal-deadline').value;
            const newPoints = document.getElementById('edit-goal-points').value;

            if (!newName) {
                alert('Please enter a goal name');
                return;
            }

            const response = await fetch('/api/goals/update', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    old_name: editingGoalName,
                    new_name: newName,
                    new_status: newStatus,
                    new_deadline: newDeadline,
                    new_points: parseInt(newPoints)
                })
            });

            const result = await response.json();
            if (result.error) {
                alert(result.error);
            } else {
                closeEditGoalModal();
                loadGoalsPage();
            }
        }

        async function deleteGoal(name) {
            if (confirm(`Delete goal "${name}"?`)) {
                await fetch('/api/goals/delete', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({name})
                });
                loadGoalsPage();
            }
        }

        function loadProgressPage() {
            // Placeholder
        }

        // Initialize
        loadDailyPage();
    </script>
</body>
</html>
